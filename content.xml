<div class="slides">
    
    <section>
        <h1>SAP PI - How We Work</h1>
        <h3>SAUG Melbourne Conference 2015</h3>
        <p>
            <small><a href="http://about.sufw.me">Sascha Wenninger</a> (<a href="http://twitter.com/sufw">@sufw</a>)</small>
        </p>
        <img src="img/Blue_T_3D.png" height="120px" style="border: none;"/>
        <img src="img/SAUG.png" height="120px" style="border: none;"/>
    </section>
    
    
    <section>
        <h2>About Me</h2>
        
    </section>
    
    
    <section>
        <h1>Some Ideas</h1>
        <p>Lean</p>
        <p>Innovation Tokens</p>
    </section>
    
    
    <section>
        <section>
            <h1>Context</h1>    
        </section>
        
    </section>
    
    
    <section>
        <h2>Standard over Proprietary</h2>
    </section>
    
    
    <section title="schemas">
        <section>
            <h1>Schemas</h1>
        </section>
        
    </section>
    
    
    
    <section title="mappings">
        <!-- Image thanks to James (https://www.flickr.com/photos/18928073@N00/2091539789) -->
        <section data-background="img/WiringDiagram.jpg">
            <h1>Mappings</h1>
        </section>
        
        <section>
            <h2>Graphical Mapping</h2>
            <ul>
                <li>Drag &amp; Drop</li>
                <li>"default" choice</li>
                <li>Looks Simple</li>
            </ul>
        </section>
        
        <section>
            <div style="display: inline-block;">
                <img src="img/GraphicalMapping.png"/>
                <div>
                    <span class="attribution"><small>Image courtesy of <a href="http://www.figaf.com">Daniel Graversen</a></small></span>
                </div>
            </div>
        </section>
        
        <section>
            <div style="display: inline-block;">
                <img src="img/GraphicalMapping_OMG.png"/>
                <div>
                    <span class="attribution"><small>Image courtesy of <a href="https://twitter.com/js1972/status/593612667060785152">Jason Scott</a></small></span>
                </div>
            </div>
            
        </section>
        
        <section data-background="img/GraphicalMapping_dark.png">
            <p>However...</p>
            <ul>
                <li>Gets unwieldy, quickly</li>
                <li>Not documentable without <a href="http://figaf.com/services/pi-documenter/">other tools</a></li>
                <li>Context-Hell is always near</li>
            </ul>
        </section>
        
        <section>
            <h1>XSLT</h1>
        </section>
        
        <section>
            <h3>Portable</h3>
            <p>Standard language</p>
            <p>Used by most middleware systems</p>
            <p>Collaboration! :-)</p>
        </section>
        
        <section>
            <h3>Documentable</h3>
            <img src="img/XSLTcomments.png"/>
        </section>
        
        <section>
            <h3>Tools: Debug!</h3>
            <img src="img/OxygenDebugger.png"/>
        </section>
        
        <section>
            <h3>Tools: Unit Tests</h3>
            <p>e.g. using <a href="http://www.jenitennison.com/xslt/xspec">XSpec</a></p>
            <ul>
                <li>Define input XML</li>
                <li>XPath assertions on output, and/or</li>
                <li>Expected XML output</li>
            </ul>
        </section>
        
        <section>
            <pre><code class="hlxml" data-trim>
<x:scenario label="Removal of ZYFC rate type in a mixed message">
    <x:context>
        <ExchangeRateReplicationRequestMessage xmlns="http://mmg.com/schemas/p2m" xmlns:prx="urn:sap.com:proxy:ECP:/1SAI/TAS5CA488983C567A6B30CB:731">
            <ExchangeRates>
                <ExchangeRate>
                    <UnitCurrency>USD</UnitCurrency>
                    <QuotedCurrency>AUD</QuotedCurrency>
                    <Rate>1.20613</Rate>
                    <RateType>M</RateType>
                    <EffectiveDate>2014-12-10</EffectiveDate>
                </ExchangeRate>
                <ExchangeRate>
                    <UnitCurrency>CAD</UnitCurrency>
                    <QuotedCurrency>HKD</QuotedCurrency>
                    <Rate>7.07113562438128</Rate>
                    <RateType>ZYFC</RateType>
                    <EffectiveDate>2014-12-10</EffectiveDate>
                </ExchangeRate>
                ...
            </ExchangeRates>
        </ExchangeRateReplicationRequestMessage>
    </x:context>
</x:scenario>
            </code></pre>
        </section>
   
        
        <section>
            <pre><code class="hlxml" data-trim>
<x:expect label="No ZYFC rate types left" test="count(//p2m:exchangerate[p2m:ratetype = 'ZYFC']) = 0"></x:expect>

<x:expect label="Checking against complete XML">
    <ExchangeRateReplicationRequestMessage xmlns="http://mmg.com/schemas/p2m" xmlns:prx="urn:sap.com:proxy:ECP:/1SAI/TAS5CA488983C567A6B30CB:731">
        <ExchangeRates>
            <ExchangeRate>
                <UnitCurrency>USD</UnitCurrency>
                <QuotedCurrency>AUD</QuotedCurrency>
                <Rate>1.20613</Rate>
                <RateType>M</RateType>
                <EffectiveDate>2014-12-10</EffectiveDate>
            </ExchangeRate>
            <ExchangeRate>
                <UnitCurrency>USD</UnitCurrency>
                <QuotedCurrency>TND</QuotedCurrency>
                <Rate>1.8566</Rate>
                <RateType>M</RateType>
                <EffectiveDate>2014-12-10</EffectiveDate>
            </ExchangeRate>
            ...
        </ExchangeRates>
    </ExchangeRateReplicationRequestMessage>
</x:expect>
            </code></pre>
        </section>
        
        
        <section>
            <img src="img/UnitTestResults.png"></img>
            <p><small><a href="https://www.youtube.com/watch?v=iPOntyq6JiE">Watch a Demo </a> by the creator <a href="http://www.jenitennison.com">Jeni T</a></small></p>
        </section>
        
        
        <section>
            <h3>Tools: <a href="http://stackoverflow.com/search?q=xslt">StackOverflow</a></h3>
            <div style="display: inline-block;">
                <img src="img/GeekPokeStackOverflow.png"/>
                <div>
                    <span class="attribution"><small>Image courtesy of <a href="http://geek-and-poke.com/geekandpoke/2013/1/22/stackoverflow.html">Geek &amp; Poke</a></small></span>
                </div>
            </div>
        </section>
        
        
        <section>
            <h3>Performance</h3>
            <p>In <em>most</em> cases a non-issue</p>
            <p><em>Used</em> to be dicey before 7.10</p>
            <p>AusPost's "POSLog" interface used only XSLT for 1m+ messages/day</p>
        </section>
        
        
        <section>
            <h2>Challenges</h2>
        </section>
        
        
        <section data-background="img/TheScream.jpg">
            <!-- Image thanks to Wikipedia (https://en.wikipedia.org/wiki/The_Scream#/media/File:The_Scream.jpg) -->
            <h2>Grouping: The Muenchian Method</h2>
        </section>
        
        
        <section>
            <table>
                <thead>
                    <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th width="100px"></th>
                        <th>Last Name</th>
                        <th>First Name</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Marie</td>
                        <td>Curie</td>
                        <td rowspan="3"></td>
                        <td>Becquerel</td>
                        <td>Henri</td>
                    </tr>
                    <tr>
                        <td>Henri</td>
                        <td>Becquerel</td>
                        
                        <td rowspan="2">Curie</td>
                        <td>Marie</td>
                    </tr>
                    <tr>
                        <td>Pierre</td>
                        <td>Curie</td>
                        
                        
                        <td>Pierre</td>
                    </tr>
                    <tr>
                        
                    </tr>
                </tbody>
            </table>
            <p>Basically the GROUP BY clause in SQL...</p>
        </section>
        
        
        <section>
            <h3>XSLT 1.0</h3>
            <pre><code class="hlxml" data-trim>
<xsl:key name="scientists-by-lastname" match="scientist" use="lastname" />
<xsl:template match="records">
    <xsl:for-each select="scientist[count(. | key('scientists-by-lastname', lastname)[1]) = 1]">
        <xsl:sort select="lastname" />
        <xsl:value-of select="lastname" />,<br />
        <xsl:for-each select="key('scientists-by-lastname', lastname)">
            <xsl:sort select="firstname" />
            <xsl:value-of select="firstname" /><br />
        </xsl:for-each>
    </xsl:for-each>
</xsl:template>
            </code></pre>
            <span class="attribution"><small>Adapted from <a href="http://www.jenitennison.com/xslt/grouping/muenchian.html">template solution</a> by Jeni T.</small></span>
        </section>
        
        
        <section>
            <h2>XSLT 2.0</h2>
            <p>Makes many things <em>much</em> simpler!</p>
            <p>Supported in a <a href="http://scn.sap.com/community/pi-and-soa-middleware/blog/2014/10/14/how-to-import-and-use-xslt-20-mappings-in-sap-pipo">limited</a> way from PI 7.31 SP11</p>
            <p>Alternative: Java wrapper.</p>
        </section>
        
        
        <section>
            <h3>XSLT 2.0</h3>
            <pre><code class="hlxml" data-trim>
<xsl:for-each-group select="LastName">
    ...
</xsl:for-each-group>
            </code></pre>
            <p>And lots of other improvements...</p>
        </section>
        
        
        <section>
            <h3>XSLT 2.0</h3>
            <p>Now supported in 7.31 and later!</p>
        </section>
        
        
    </section>
    
    
    
    <section title="source control">
        <section data-background="img/Evolution.jpg">
            <h1>Source Control</h1>
            <!-- Image thanks to spykster (https://www.flickr.com/photos/spykster/7625762720) -->
        </section>
        
        <section>
            <p>Needed a way to address shortcomings of the ESR:</p>
            <ul>
                <li>conflicts with concurrent edits</li>
                <li>visibility/blame</li>
                <li>non-code artefacts (e.g. scripts)</li>
            </ul>
        </section>
        
        <section>
            <img src="img/GitHubBrandMark.png" style="border: none; background:none; box-shadow: none;"/>
        </section>
        
        <section>
            <div style="display: inline-block;">
                <img src="img/xkcd1597.png"/>
                <div><span class="attribution"><small>Image courtesy of <a href="http://xkcd.com/1597/">xkcd</a></small></span></div>
            </div>
            

        </section>
        
        <section>
            <h3>Started simple</h3>
            <p>Initial learning curve</p>
            <p>Discipline required</p>
        </section>
        
        <section>
            <h1>TODO: linear master graph view</h1>
        </section>
        
        <section>
            <img src="img/austin_powers.jpg" style="border: none;"/>
        </section>
        
        <section>
            <h3>Being Polite: Pull Requests</h3>
            <h1>TODO: some Visio</h1>
        </section>
        
        <section>
            <h3>Possibilities</h3>
            <p>Code reviews before merging into master</p>
            <p>Offshore development: Only trusted devs have merge rights</p>
            <p>Avoid edit conflicts</p>
        </section>
        
        <section>
            <h3>What's Next?</h3>
            <div style="display: inline-block;">
                <a href="https://www.review.ninja/">
                    <img src="img/ReviewNinjaGirl.png" style="border: none; background:none; box-shadow: none;"/>
                </a>
                <div><p>An <a href="https://www.review.ninja/">SAP tool</a> for Github code review!</p></div>
            </div>
            
        </section>
    </section>
    


    <section title="alerting">
        <section data-background="img/SafetyFirst.jpg">
            <h1>Alerting</h1>
        </section>
        
        
        <section>
            <h3>It's a Problem...</h3>
            <div style="display: inline-block;">
                <img src="img/MonitoringBigIssue.png"/>
                <div>
                    <span class="attribution"><small>Source: <a href="http://scn.sap.com/community/process-orchestration/blog/2015/10/28/results-of-the-global-survey-for-sap-process-integration-part-1-of-2">IFG for PI Annual Survey</a></small></span>
                </div>
            </div>
            
        </section>
        
        
        <section>
            <h2>SAP Standard</h2>
            <p>Traditional Alert Framework</p>
            <p>Since 7.3: also Component-Based Message Alerting &amp; SolMan</p>
        </section>
        
        
        <section>
            <p>Difficult to set up; <em>very</em> sparse documentation</p>
            <p>SolMan as central monitor, polls other systems for alerts</p>
            <p>Lots of noise &amp; false positives</p>
        </section>
        
        
        <section>
            <h3>IFG Survey</h3>
            <p>25% adoption</p>
            <p>Barriers: 
                <ol>
                    <li>20%: org issues</li>
                    <li>15%: lack of skills</li>
                </ol>
            </p>
        </section>
        
        
        <section>
            <h2>MMG's Journey</h2>
            <ol>
                <li>Alert Framework</li>
                <li>CBMA</li>
                <li>Custom Solution</li>
            </ol>
        </section>
        
        
        <section>
            <h3>Aims</h3>
            <p>Simple</p>
            <p style="text-decoration: line-through; color: grey;">Email</p>
            <p style="text-decoration: line-through; color: grey;">Noise</p>
        </section>
        
        <section>
            
        </section>
        
        
        <section>
            <h3>Initial Design</h3>
            <em>Insert Diagram here</em>
        </section>
        
        
    </section>  
    
</div>
